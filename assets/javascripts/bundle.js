!function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){r(1)},function(t,e,r){"use strict";var n,o,a,c,s,i,u,l,p,m,d,f,g,h,v,w,S,y,I,b,k,j,x,B,_,C,O,P,G,E,T,F,N,U,M,W,z,R,D,J,L,V,q,A,Q,H,K,X,Y,Z,tt=[].indexOf;D="https://xlv7zi96k3.execute-api.ap-northeast-1.amazonaws.com/prod/",W=0,_=0,c="",s="",i=0,d=!1,Y=null,E=null,F=!1,N=null,R=!1,f=0,a=[],S=1,y="setting.comment",I="setting.count",j="setting.spgift",k="setting.paidgift",b="setting.freegift",x="setting.voice",J=!1,L=!1,Q=!1,A=!1,V=!1,T=!1,U=["�[�-�]","�[�-�]","�[�-�]","퟉[�-�]","[☀-➿]",'["#$&()*/:;<=>@[\\]^_`{|}~]',"[　”＃’（）＊．／：；＜＞＠［￥］＾＿‘｛｜｝￣・゛゜´｀¨ヽヾゝゞ〃〇―‐＼∥‥“〔〕〈〉《》「」『』【】±×÷≠≦≧∞∴♂♀°′″℃￠￡§☆★○●◎◇◇◆□■△▲▽▼※〒→←↑↓〓]"],B=new RegExp(U.join("|"),"g"),Z=new RegExp("[wWｗＷ][wWｗＷ][wWｗＷ]+","g"),p=function(){return $("#message").html(""),f=0},q=function(t){return $("#message").html(t)},X=function(){return $("#room_url").val()},v=function(){return D+X()},u=function(){return W=0,_=0,c="",s="",i=0,a=[]},M=function(t){var e,r,n;return n=new DOMParser,e=n.parseFromString(t,"text/html"),e.getElementById("js-live-data")?(r=JSON.parse(e.getElementById("js-live-data").getAttribute("data-json")),W=parseInt(r.room_id),_=parseInt(r.live_id),c=r.broadcast_key,s=r.broadcast_host,i=r.broadcast_port,!0):void q("ライブが終了しています")},H=function(){var t;return p(),t=v(),$.ajax({type:"GET",url:t,success:function(t){var e;return F=!1,e=M(t),e?m():void u()},error:function(t,e,r){return F=!1,q("ページがみつかりません")}})},g=function(){return null!==Y&&(Y.send("QUIT"),Y.close(),Y=null,clearInterval(E)),d=!1,$("#connectButton").html("接続"),$("#connectButton").removeClass("gray"),$("#room_url").prop("disabled",!1)},O=function(){return d?(g(),F=!1):""===X()?(q("URLを入力してください。"),void(F=!1)):H()},m=function(){return l(),a=[],Y&&g(),Y=new WebSocket("ws://"+s+":"+i),Y.onopen=function(){return Y.send("SUB\t"+c),Y.onmessage=P,d=!0,$("#connectButton").html("切断"),$("#connectButton").addClass("gray"),$("#room_url").prop("disabled",!0)},E=setInterval(function(){return Y&&Y.readyState===Y.OPEN?Y.send("PING"):g()},3e4)},P=function(t){var e,r,c,s,i,u;if(t.isTrusted&&(i=t.data.split("\t"),!(i.length<2||"MSG"!==i[0])&&(c=i[2])&&(r=JSON.parse(c),1===(u=parseInt(r.t))||2===u)))return s=new Date,e={type:u,json:r,time:s.toLocaleString()},a.push(e),1===u&&(n(e),f+=1,$("#comment-count").html(f)),2===u&&o(e),R?N.cache():void 0},n=function(t){var e,r,n,o,a,c,s;if(a=t.json.ac,r=t.json.cm,e=t.json.av,r.match(/^[1-5]?[0-9]$/)){if(!L)return}else if(!J)return;if(n=S++,s="<tr> <td class='user-column'> <img class='avatar' id='user-img-"+n+"' src='https://image.showroom-live.com/showroom-prod/image/avatar/"+e+".png'> "+a+" </td> <td class='date-column'>"+t.time+"</td> <td>"+r+"</td> </tr>",$("#main-tbody").prepend(s),c=!1,!(tt.call(window,c)>=0)&&T)return o=new SpeechSynthesisUtterance,o.volume=.3,o.rate=1,o.pitch=1.2,o.text=a.replace(B," ").substr(0,5)+"さん。"+r.replace(B," ").replace(Z,"www"),o.lang="ja-UP",speechSynthesis.speak(o)},o=function(t){var e,r,n,o,a,c,s,i;if(r=t.json.g,n=parseInt(t.json.gt),o=parseInt(t.json.h),s=t.json.n,c=t.json.ac,e=t.json.av,1===o){if(!Q)return}else if(1===n){if(!A)return}else if(!V)return;return a=S++,i="<tr> <td class='user-column'> <img class='avatar' id='user-img-"+a+"' src='https://image.showroom-live.com/showroom-prod/image/avatar/"+e+".png'> "+c+" </td> <td class='date-column'>"+t.time+"</td> <td> <img class='gift' id='gift-img-"+a+"' src='https://image.showroom-live.com/showroom-prod/assets/img/gift/"+r+"_s.png'> <span class='gift-num'>x"+s+"</span> </td> </tr>",$("#main-tbody").prepend(i)},l=function(){return $("#main-tbody").html("")},G=function(){return R?h():K()},$("#room_url").keypress(function(t){if(13===t.which)return $("#connectButton").click()}),K=function(){return N.cache(),N.trigger(),$("#searchButton").html("ON"),$("#searchButton").removeClass("gray"),R=!0,$("#filterText").prop("disabled",!1)},h=function(){return R=!1,$("#searchButton").html("OFF"),$("#searchButton").addClass("gray"),$("#filterText").prop("disabled",!0),N.reset(),N.search("")},C=function(){var t;if(t={},t[y]=localStorage.getItem(y),t[I]=localStorage.getItem(I),t[j]=localStorage.getItem(j),t[b]=localStorage.getItem(b),t[k]=localStorage.getItem(k),t[x]=localStorage.getItem(x),t[y]||(t[y]="true"),"true"===t[y]&&(J=!0,$("#showComment").prop("checked",!0)),"true"===t[I]&&(L=!0,$("#showCountComment").prop("checked",!0)),t[j]||(t[j]="true"),"true"===t[j]&&(Q=!0,$("#showSPGift").prop("checked",!0)),t[k]||(t[k]="true"),"true"===t[k]&&(A=!0,$("#showPaidGift").prop("checked",!0)),"true"===t[b]&&(V=!0,$("#showFreeGift").prop("checked",!0)),"true"===t[x])return T=!0,$("#playVoice").prop("checked",!0)},z=function(){return J=$("#showComment").prop("checked"),L=$("#showCountComment").prop("checked"),Q=$("#showSPGift").prop("checked"),A=$("#showPaidGift").prop("checked"),V=$("#showFreeGift").prop("checked"),T=$("#playVoice").prop("checked"),localStorage.setItem(y,J),localStorage.setItem(I,L),localStorage.setItem(j,Q),localStorage.setItem(k,A),localStorage.setItem(b,V),localStorage.setItem(x,T)},w=function(){if(z(),l(),a.forEach(function(t){if(1===t.type&&n(t),2===t.type)return o(t)}),R)return N.cache()},$(function(){return $("#connectButton").click(function(){return!F&&(F=!0,O())}),$("table").resizableColumns(),N=$("#filterText").quicksearch("table tbody tr"),$("#searchButton").click(function(){return G()}),$("#setting-open").leanModal({closeButton:".modal-close"}),C(),$("input.gift-setting").change(w)})}]);